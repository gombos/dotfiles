cd /tmp

rm -rf /tmp/gh-cli-cache
rm -rf /tmp/wiki
rm -rf dracut/
git clone git@github.com:dracutdevs/dracut.git
cd dracut

# new origin
git branch -m origin
git remote set-url origin git@github.com:dracutdevs-extra/dracut-canary.git
git config advice.skippedCherryPicks false
git push origin HEAD

# reset master
git branch -m master
git push -f origin HEAD

# reset originprs
git branch -m originprs
git push -f origin HEAD

git clone https://github.com/dracutdevs-extra/dracut-canary.wiki.git /tmp/wiki
cat /tmp/wiki/prlist.* | tr '\*' ' ' | sed '/^[[:blank:]]*#/d;s/#.*//' | sed 's/^[ \t]*//' | grep '[0-9]' | sed '/^$/d' | sort -r > prlist

while read p;
    do gh pr checkout --repo dracutdevs/dracut $p
    git branch -m $p
done <prlist

git checkout originprs
while read p; do git rebase $p && git pull ;done <prlist

git add prlist
git commit -m "dracut upstream list of PRs"

git push origin HEAD

# phase 2
rm -rf /tmp/gh-cli-cache
cd /tmp/
rm -rf dracut-canary
git clone -b originprs git@github.com:dracutdevs-extra/dracut-canary.git
cd dracut-canary
git config advice.skippedCherryPicks false
git branch -m master
git push -f origin HEAD
gh pr list --limit 1000 --repo laszlogombos/dracut --search "milestone:milestone" | cut -f1 | sort -r | uniq > list
while read p; do gh pr checkout --repo laszlogombos/dracut $p && git branch -m $p ;done <list
git checkout master
while read p; do git rebase $p && git pull ;done <list
git push origin HEAD
