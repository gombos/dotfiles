# Base image could be independent from rootfs

FROM 0gombi0/homelab:kernel as kernel

FROM alpine

COPY --from=kernel /efi /efi

#FROM docker.io/gentoo/portage:latest as portage
#FROM docker.io/gentoo/stage3:musl
#COPY --from=kernel /efi /efi
#COPY --from=portage /var/db/repos/gentoo /var/db/repos/gentoo

COPY bin/* /tmp/
COPY boot/ /tmp/
WORKDIR /tmp
RUN /bin/sh -c '. ./infra-build-boot.sh'
